# –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–∫ –∫–æ–¥ - Ansible + Vagrant + Docker

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ "–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–∫ –∫–æ–¥" (Infrastructure as Code, IaC) –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è Django –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö, —É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö —á–µ—Ä–µ–∑ Vagrant –∏ Ansible.

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞](#–æ–±–∑–æ—Ä-–ø—Ä–æ–µ–∫—Ç–∞)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤](#–æ–ø–∏—Å–∞–Ω–∏–µ-—Ñ–∞–π–ª–æ–≤)
- [–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)

## üéØ –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–∞–∫ –∫–æ–¥—É, –æ–±—ä–µ–¥–∏–Ω—è—è:
- **Vagrant** - –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ –º–∞—à–∏–Ω–∞–º–∏
- **Ansible** - –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- **Docker** - –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

–¶–µ–ª—å: –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –¥–≤—É—Ö –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö) —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º Django –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ Vagrantfile                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω
‚îú‚îÄ‚îÄ inventory.ini              # –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å Ansible (—Å–ø–∏—Å–æ–∫ —Ö–æ—Å—Ç–æ–≤)
‚îú‚îÄ‚îÄ requirements.yml           # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Ansible —Ä–æ–ª–µ–π
‚îú‚îÄ‚îÄ install_docker.yml         # Playbook –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Docker
‚îú‚îÄ‚îÄ deploy_app.yml            # Playbook –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ setup_with_role.yml       # Playbook —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–æ–ª–∏
‚îú‚îÄ‚îÄ group_vars/               # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≥—Ä—É–ø–ø —Ö–æ—Å—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ app.yml              # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≥—Ä—É–ø–ø—ã app
‚îî‚îÄ‚îÄ roles/                    # Ansible —Ä–æ–ª–∏
    ‚îî‚îÄ‚îÄ docker/              # –†–æ–ª—å –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Docker
        ‚îú‚îÄ‚îÄ defaults/        # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        ‚îú‚îÄ‚îÄ tasks/           # –ó–∞–¥–∞—á–∏ —Ä–æ–ª–∏
        ‚îú‚îÄ‚îÄ handlers/        # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        ‚îú‚îÄ‚îÄ vars/            # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏
        ‚îú‚îÄ‚îÄ meta/            # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ä–æ–ª–∏
        ‚îú‚îÄ‚îÄ tests/           # –¢–µ—Å—Ç—ã —Ä–æ–ª–∏
        ‚îî‚îÄ‚îÄ README.md        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–æ–ª–∏
```

## üìù –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

#### `Vagrantfile`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**:
- –°–æ–∑–¥–∞–µ—Ç 2 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –Ω–∞ –±–∞–∑–µ Ubuntu 20.04 (focal64)
- **app1** (192.168.56.10) - –º–∞—à–∏–Ω–∞ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - 1 CPU, 1GB RAM
  - –ò–º—è –≤ VirtualBox: `app1-lab-ansible`
- **db1** (192.168.56.11) - –º–∞—à–∏–Ω–∞ –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
  - 1 CPU, 1GB RAM
  - –ò–º—è –≤ VirtualBox: `db1-lab-ansible`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```bash
vagrant up        # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –º–∞—à–∏–Ω—ã
vagrant ssh app1  # –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –º–∞—à–∏–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
vagrant destroy   # –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –º–∞—à–∏–Ω—ã
```

#### `inventory.ini`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ò–Ω–≤–µ–Ω—Ç–∞—Ä–Ω—ã–π —Ñ–∞–π–ª Ansible, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å–ø–∏—Å–æ–∫ —É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö —Ö–æ—Å—Ç–æ–≤ –∏ –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞**:
- `[app]` - –≥—Ä—É–ø–ø–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (app1)
- `[db]` - –≥—Ä—É–ø–ø–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö (db1)
- `[all:vars]` - –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö —Ö–æ—Å—Ç–æ–≤

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**:
- IP –∞–¥—Ä–µ—Å–∞ —Ö–æ—Å—Ç–æ–≤
- SSH –∫–ª—é—á–∏ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ SSH host key
- –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä Python

### Ansible Playbooks

#### `install_docker.yml`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Playbook –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Docker –Ω–∞ –≤—Å–µ—Ö —Ö–æ—Å—Ç–∞—Ö.

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**:
1. –û–±–Ω–æ–≤–ª—è–µ—Ç –∫—ç—à –ø–∞–∫–µ—Ç–æ–≤ APT
2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (curl, gnupg, ca-certificates)
3. –î–æ–±–∞–≤–ª—è–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π GPG –∫–ª—é—á Docker
4. –î–æ–±–∞–≤–ª—è–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Docker
5. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Docker CE, Docker CLI –∏ containerd
6. –ó–∞–ø—É—Å–∫–∞–µ—Ç –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Å–ª—É–∂–±—É Docker
7. –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è vagrant –≤ –≥—Ä—É–ø–ø—É docker
8. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```bash
ansible-playbook -i inventory.ini install_docker.yml
```

#### `deploy_app.yml`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Playbook –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è Django –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**:
1. –°–∫–∞—á–∏–≤–∞–µ—Ç Docker –æ–±—Ä–∞–∑ `timurbabs/django`
2. –ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å Django –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º:
   - –ò–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: `django_app`
   - –ü–æ—Ä—Ç: 8000
   - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: DEBUG, SECRET_KEY, ALLOWED_HOSTS
   - –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞: gunicorn
   - –ü–æ–ª–∏—Ç–∏–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞: always
3. –û–∂–∏–¥–∞–µ—Ç –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–¥–æ 120 —Å–µ–∫—É–Ω–¥)
4. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
5. –í—ã–≤–æ–¥–∏—Ç ID –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```bash
ansible-playbook -i inventory.ini deploy_app.yml
```

#### `setup_with_role.yml`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π playbook, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –≥–æ—Ç–æ–≤—É—é —Ä–æ–ª—å –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Docker.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ —Ä–æ–ª–∏
- –ë–æ–ª–µ–µ —á–∏—Å—Ç—ã–π –∏ —á–∏—Ç–∞–µ–º—ã–π –∫–æ–¥
- –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```bash
ansible-playbook -i inventory.ini setup_with_role.yml
```

#### `requirements.yml`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—Ä–æ–ª–∏) –¥–ª—è Ansible –ø—Ä–æ–µ–∫—Ç–∞.

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**:
- –ò—Å—Ç–æ—á–Ω–∏–∫: GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (https://github.com/Zisrf/infrasture-as-a-code.git)
- –¢–∏–ø: Git SCM
- –í–µ—Ç–∫–∞: main
- –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–æ–ª–∏: docker

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```bash
ansible-galaxy install -r requirements.yml
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

#### `group_vars/app.yml`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –≥—Ä—É–ø–ø—ã —Ö–æ—Å—Ç–æ–≤ `[app]`.

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**:
- `app_name`: "django-locallibrary" - –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `app_port`: 8000 - –ø–æ—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `deploy_user`: "vagrant" - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

**–û–±–ª–∞—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏—è**: –≠—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ playbooks –Ω–∞ —Ö–æ—Å—Ç–∞—Ö –∏–∑ –≥—Ä—É–ø–ø—ã `[app]`.

### –†–æ–ª–∏ Ansible

#### `roles/docker/`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Ansible —Ä–æ–ª—å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Docker.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–æ–ª–∏**:

##### `roles/docker/tasks/main.yml`
–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Ä–æ–ª–∏:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Docker
- –£—Å–ª–æ–≤–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ GPG –∫–ª—é—á–∞
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ Docker
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ª—É–∂–±—ã
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É docker

##### `roles/docker/defaults/main.yml`
–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
- `docker_gpg_key` - URL GPG –∫–ª—é—á–∞ Docker
- `docker_repository` - —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Docker –¥–ª—è Ubuntu
- `docker_packages` - —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
- `docker_user` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø—É docker

##### `roles/docker/vars/main.yml`
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏ (–ø—É—Å—Ç–æ–π —Ñ–∞–π–ª, –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω –¥–ª—è –±—É–¥—É—â–∏—Ö –Ω—É–∂–¥).

##### `roles/docker/handlers/main.yml`
–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–ª—É–∂–± –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏).

##### `roles/docker/meta/main.yml`
–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ä–æ–ª–∏:
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥—Ä—É–≥–∏—Ö —Ä–æ–ª–µ–π
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–µ

##### `roles/docker/tests/`
–¢–µ—Å—Ç—ã –¥–ª—è —Ä–æ–ª–∏:
- `test.yml` - —Ç–µ—Å—Ç–æ–≤—ã–π playbook
- `inventory` - –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

##### `roles/docker/README.md`
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–æ–ª–∏ (—à–∞–±–ª–æ–Ω –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è).

## ‚öôÔ∏è –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –õ–æ–∫–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞:
- **VirtualBox** (>=6.0)
- **Vagrant** (>=2.2)
- **Ansible** (>=2.9)

### –î–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏:
- Ubuntu 20.04 –∏–ª–∏ –≤—ã—à–µ
- SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä–∞–º
- Sudo –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –Ω–∞ —Ü–µ–ª–µ–≤—ã—Ö —Ö–æ—Å—Ç–∞—Ö

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)

1. **–°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã**:
```bash
vagrant up
```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker –Ω–∞ –≤—Å–µ —Ö–æ—Å—Ç—ã**:
```bash
ansible-playbook -i inventory.ini install_docker.yml
```
–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—è —Ä–æ–ª—å:
```bash
ansible-galaxy install -r requirements.yml
ansible-playbook -i inventory.ini setup_with_role.yml
```

3. **–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å Django –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**:
```bash
ansible-playbook -i inventory.ini deploy_app.yml
```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**:
```bash
curl http://192.168.56.10:8000
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ö–æ—Å—Ç–æ–≤
ansible -i inventory.ini all -m ping

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é Docker
ansible -i inventory.ini all -m shell -a "docker --version"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
ansible -i inventory.ini app -m shell -a "docker ps"
```

### –û—á–∏—Å—Ç–∫–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã
vagrant destroy -f
```

## üîß –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `deploy_app.yml`:
- –ò–∑–º–µ–Ω–∏—Ç–µ Docker –æ–±—Ä–∞–∑ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `docker_image`
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ —Å–µ–∫—Ü–∏–∏ `env`
- –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç—ã –≤ —Å–µ–∫—Ü–∏–∏ `ports`

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ö–æ—Å—Ç–æ–≤
1. –î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Å—Ç –≤ `Vagrantfile`
2. –î–æ–±–∞–≤—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å –≤ `inventory.ini`
3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ `group_vars/`

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ä–æ–ª–∏
```bash
ansible-galaxy init roles/my_role
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Ansible](https://docs.ansible.com/)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Vagrant](https://www.vagrantup.com/docs)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Docker](https://docs.docker.com/)

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è –ª—é–±—ã–µ —É–ª—É—á—à–µ–Ω–∏—è! –ù–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å —Å–æ–∑–¥–∞–≤–∞—Ç—å issues –∏ pull requests.

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π.
